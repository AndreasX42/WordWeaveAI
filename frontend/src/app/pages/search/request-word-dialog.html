<h2 mat-dialog-title>
  <mat-icon>add_circle</mat-icon>
  {{ "search.requestWord.dialog.title" | translate }}
</h2>

<mat-dialog-content>
  <div class="form-section">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>{{
        "search.requestWord.dialog.sourceWordPlaceholder" | translate
      }}</mat-label>
      <input
        matInput
        [formControl]="sourceWordControl"
        [matTooltip]="'search.requestWord.dialog.sourceWordHint' | translate"
        matTooltipPosition="below"
      />
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>{{
        "search.requestWord.dialog.sourceLanguage" | translate
      }}</mat-label>
      <mat-select [formControl]="sourceLanguageControl">
        <mat-option value="">{{
          "search.requestWord.dialog.autoDetect" | translate
        }}</mat-option>
        @for (l of translationService.languages; track l.code) {
        <mat-option
          [value]="l.code"
          [attr.value]="l.code"
          [disabled]="targetLanguageControl.value === l.code"
          >{{ l.name }}</mat-option
        >
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>{{
        "search.requestWord.dialog.targetLanguage" | translate
      }}</mat-label>
      <mat-select [formControl]="targetLanguageControl">
        @for (l of translationService.languages; track l.code) {
        <mat-option
          [value]="l.code"
          [attr.value]="l.code"
          [disabled]="sourceLanguageControl.value === l.code"
          >{{ l.name }}</mat-option
        >
        }
      </mat-select>
    </mat-form-field>
  </div>

  <!-- Validation Messages -->
  <div class="validation-section" *ngIf="validationErrors.length > 0">
    <div class="validation-error" *ngFor="let error of validationErrors">
      <mat-icon>error_outline</mat-icon>
      <span>{{ error }}</span>
    </div>
  </div>

  <!-- Existing Results Warning -->
  <div class="existing-results" *ngIf="existingResults.length > 0">
    <mat-icon>info</mat-icon>
    <div class="warning-content">
      <p class="warning-title">
        {{ "search.requestWord.dialog.existingResults" | translate }}
      </p>
      <div class="existing-items">
        <div class="existing-item" *ngFor="let result of existingResults">
          <img
            [src]="getLanguageFlag(result.source_language)"
            [alt]="'Source language flag'"
            class="flag"
            width="16"
            height="12"
          />
          <span class="word">{{ result.source_word }}</span>
          <mat-icon class="arrow">arrow_forward</mat-icon>
          <img
            [src]="getLanguageFlag(result.target_language)"
            [alt]="'Target language flag'"
            class="flag"
            width="16"
            height="12"
          />
          <span class="word">{{ result.target_word }}</span>
        </div>
      </div>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">
    {{ "common.cancel" | translate }}
  </button>
  <button
    mat-raised-button
    color="primary"
    (click)="onSubmit()"
    [disabled]="!isFormValid()"
  >
    {{ "search.requestWord.dialog.submit" | translate }}
  </button>
</mat-dialog-actions>
